#V2
CREATE EXTERNAL TABLE hits\nSTORED AS PARQUET\nLOCATION '/Users/mingying/Documents/hits.parquet';
select count(*) from hits;
SELECT DATE_TRUNC('minute', "EventTime") AS M, COUNT(*) AS PageViews FROM hits WHERE "CounterID" = 62 AND "EventDate" >= '2013-07-14' AND "EventDate" <= '2013-07-15' AND "IsRefresh" = 0 AND "DontCountHits" = 0 GROUP BY DATE_TRUNC('minute', "EventTime") ORDER BY DATE_TRUNC('minute', "EventTime") LIMIT 10 OFFSET 1000;
SELECT DATE_TRUNC('minute', to_timestamp_seconds("EventTime")) AS M, COUNT(*) AS PageViews FROM hits WHERE "CounterID" = 62 AND "EventDate"::INT::DATE >= '2013-07-14' AND "EventDate"::INT::DATE <= '2013-07-15' AND "IsRefresh" = 0 AND "DontCountHits" = 0 GROUP BY DATE_TRUNC('minute', to_timestamp_seconds("EventTime")) ORDER BY DATE_TRUNC('minute', M) LIMIT 10 OFFSET 1000;
select * from hits where "EventDate" >= '2013-07-14' limit 1;
select "EventTime" from hits limit 1;
select to_timestamp_seconds("EventTime") from hits limit 1;
select "EventDate" from hits limit 1;
select '1970-01-01'::date\n;
select '1970-01-01'::date + 15901;
select 15901 / 365;
\\q
select to_timestamp_millis(1238123);
select to_timestamp_millis('2023-01-31T09:26:56.123456789-05:00');
\\q
